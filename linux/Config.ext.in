menu "Linux Kernel Extensions"

# Xenomai
config BR2_LINUX_KERNEL_EXT_XENOMAI
	bool "Adeos/Xenomai Real-time patch"
	depends on BR2_TOOLCHAIN_HAS_THREADS
	depends on BR2_i386 || BR2_x86_64 || BR2_arm || \
		   BR2_bfin || BR2_powerpc || BR2_sh4
	select BR2_PACKAGE_XENOMAI
	help
	  Xenomai is split in two parts: a kernel part and a userspace
	  part. Enabling this option automatically selects the Xenomai
	  package and helps in patching the Linux kernel built by
	  Buildroot with the Xenomai kernel part (ie Adeos/Ipipe).

	  You can find the currently supported kernel versions by
	  looking at the available patches in the Xenomai sources
	  tree: ksrc/arch/$(ARCH)/patches

	  However, it is recommended to use the latest version of the
	  Adeos/Ipipe patch available at
	  http://download.gna.org/adeos/patches

	  Xenomai is know to support Blackfin, SH4, x86, ARM, NIOS2
	  and PowerPC architectures.

comment "xenomai needs a toolchain w/ threads"
	depends on BR2_i386 || BR2_x86_64 || BR2_arm || \
		   BR2_bfin || BR2_powerpc || BR2_sh4
	depends on !BR2_TOOLCHAIN_HAS_THREADS

config BR2_LINUX_KERNEL_EXT_XENOMAI_ADEOS_PATCH
	depends on BR2_LINUX_KERNEL_EXT_XENOMAI
	string "Path for Adeos patch file"
	help
	  Optionally, explicitly specify the Adeos patch to use.
	  Download it at http://download.gna.org/adeos/patches
	  and verify that your kernel version in buildroot matches.

# RTAI
config BR2_LINUX_KERNEL_EXT_RTAI
	bool "RTAI Real-time patch"
	select BR2_PACKAGE_RTAI
	help
	  RTAI Kernel part.

# fbtft
config BR2_LINUX_KERNEL_EXT_FBTFT
	bool "FB TFT drivers"
	select BR2_PACKAGE_FBTFT
	help
	  Linux Framebuffer drivers for small TFT LCD display modules,
	  e.g. Adafruit PiTFT displays for Raspberry Pi (this extra
	  package is only needed for linux kernels until v3.19, since
	  v4.0 the drivers are included in the staging area).

	  To enable fbtft, e.g. for Adafruit 2.8 PiTFT, enable the
	  following kernel configurations:
	  - CONFIG_SPI
	  - CONFIG_GPIOLIB
	  - CONFIG_FB
	  - CONFIG_FB_TFT
	  - CONFIG_FB_TFT_ILI9341

	  https://github.com/notro/fbtft

# aufs-standalone
config BR2_LINUX_KERNEL_EXT_AUFS_STANDALONE
	bool "Aufs Filesystem Module patch"
	depends on BR2_USE_MMU
	depends on BR2_TOOLCHAIN_HAS_THREADS
	select BR2_PACKAGE_AUFS_STANDALONE
	help
	  Aufs is split in two parts: a kernel part and a userspace
	  part. Enabling this option automatically selects the aufs
	  standalone (module) package and patches the Linux kernel
	  built by Buildroot with the aufs kernel part (ie fs/aufs).

	  It is important to use the correct branch of aufs-standalone.

comment "aufs needs a toolchain w/ threads"
	depends on BR2_USE_MMU
	depends on !BR2_TOOLCHAIN_HAS_THREADS

choice
	prompt "aufs major version"
	depends on BR2_LINUX_KERNEL_EXT_AUFS_STANDALONE
	default BR2_PACKAGE_AUFS_4X if BR2_KERNEL_HEADERS_4_0 || BR2_KERNEL_HEADERS_4.1
	default BR2_PACKAGE_AUFS_3X if !(BR2_KERNEL_HEADERS_4_0 || BR2_KERNEL_HEADERS_4.1)

config BR2_PACKAGE_AUFS_STANDALONE_4X
	bool "4.x"

config BR2_PACKAGE_AUFS_STANDALONE_3X
	bool "3.x"

endchoice

# While we don't build from the kernel headers
# we can get a default value here
config BR2_PACKAGE_AUFS_STANDALONE_VERSION
	string "aufs-standalone branch"
	depends on BR2_LINUX_KERNEL_EXT_AUFS_STANDALONE
	help
	  Aufs-standalone repository branch to use. Must match kernel version.
	default "3.0"  if BR2_KERNEL_HEADERS_3_0
	default "3.1"  if BR2_KERNEL_HEADERS_3_2 || BR2_KERNEL_HEADERS_3_4
	default "3.10" if BR2_KERNEL_HEADERS_3_10
	default "3.11" if BR2_KERNEL_HEADERS_3_11
	default "3.12" if BR2_KERNEL_HEADERS_3_12
	default "3.13" if BR2_KERNEL_HEADERS_3_13
	default "3.14" if BR2_KERNEL_HEADERS_3_14
	default "3.15" if BR2_KERNEL_HEADERS_3_15
	default "3.16" if BR2_KERNEL_HEADERS_3_16
	default "3.17" if BR2_KERNEL_HEADERS_3_17
	default "3.18" if BR2_KERNEL_HEADERS_3_18
	default "3.19" if BR2_KERNEL_HEADERS_3_19
	default "4.0"  if BR2_KERNEL_HEADERS_4_0
	default "4.1"  if BR2_KERNEL_HEADERS_4_1

endmenu
